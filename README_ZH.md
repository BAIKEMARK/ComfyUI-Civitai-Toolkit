# Civitai Recipe Finder (Civitai é…æ–¹æŸ¥æ‰¾å™¨)

## é¡¹ç›®ç®€ä»‹

åœ¨ AI ç»˜ç”»åˆ›ä½œä¸­ï¼Œæ‰¾åˆ°ç†æƒ³çš„â€œ**é…æ–¹ (Recipe)**â€â€”â€”å³æ¨¡å‹ã€è§¦å‘è¯ã€æç¤ºè¯ä¸ç”Ÿæˆå‚æ•°çš„æœ€ä½³ç»„åˆï¼Œå¾€å¾€æ¯”å•çº¯çš„å‚æ•°è°ƒèŠ‚æ›´ä¸ºå…³é”®ã€‚

**Civitai Recipe Finder** æ˜¯ä¸€å¥—ä¸“ä¸º **ComfyUI** è®¾è®¡çš„å¼ºå¤§èŠ‚ç‚¹å·¥å…·é›†ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ å¿«é€Ÿæ¢ç´¢ã€å¤ç°å’Œåˆ†æ Civitai ç¤¾åŒºçš„åˆ›ä½œé…æ–¹ï¼Œç”šè‡³ä¸ºæœ¬åœ°æ¨¡å‹æä¾›å³æ—¶çš„å¯è§†åŒ–å‚è€ƒã€‚

æ— è®ºæ˜¯æƒ³ä¸€é”®å¤ç°çƒ­é—¨ä½œå“ï¼Œè¿˜æ˜¯æ·±å…¥ç ”ç©¶ç¤¾åŒºçš„ä½¿ç”¨è¶‹åŠ¿ï¼Œæœ¬å·¥å…·éƒ½èƒ½ä¸ºä½ æä¾› **é«˜æ•ˆã€ç›´è§‚ã€çµæ´»** çš„æ”¯æŒã€‚

---

## åŠŸèƒ½äº®ç‚¹

* ğŸ” **å¯è§†åŒ–æŸ¥æ‰¾é…æ–¹**
  å³æ—¶æµè§ˆæŸä¸ªæœ¬åœ°æ¨¡å‹åœ¨ Civitai çš„çƒ­é—¨ä½œå“ï¼Œå¹¶ä¸€é”®å¤ç°å®Œæ•´é…æ–¹ï¼ˆæç¤ºè¯ã€å‚æ•°ã€LoRA ç»„åˆã€å·¥ä½œæµç­‰ï¼‰ã€‚

* âš¡ **å³æ—¶è§¦å‘è¯è·å–**
  å¿«é€Ÿæå– LoRA æ¨¡å‹çš„å®˜æ–¹è§¦å‘è¯å’Œæœ¬åœ°å…ƒæ•°æ®è§¦å‘è¯ã€‚

* ğŸ“Š **æ·±åº¦ç¤¾åŒºè¶‹åŠ¿åˆ†æ**
  æ±‡æ€»æ•°ç™¾å¼ ç¤¾åŒºä½œå“ï¼Œæ‰¾å‡ºæœ€å¸¸ç”¨çš„æ­£/è´Ÿå‘æç¤ºè¯ã€é‡‡æ ·å™¨ã€CFGã€æ­¥æ•°ç­‰å‚æ•°ã€‚

* ğŸ”— **é»„é‡‘ç»„åˆå‘ç°**
  æ­ç¤ºæŸä¸ªæ¨¡å‹å¸¸ä¸å“ªäº›å…¶ä»– LoRA æ­é…ä½¿ç”¨ã€‚

* ğŸ›  **æ¨¡å—åŒ–ä¸é«˜æ‰©å±•æ€§**
  å·¥å…·ä»¥èŠ‚ç‚¹å¥—ä»¶å½¢å¼æä¾›ï¼Œæ—¢èƒ½æ»¡è¶³æ—¥å¸¸çš„è½»é‡çº§æ“ä½œï¼Œä¹Ÿèƒ½æ”¯æŒå¤æ‚çš„æ·±åº¦åˆ†æå·¥ä½œæµã€‚

---

## èŠ‚ç‚¹å¥—ä»¶è¯´æ˜

Recipe Finder åŒ…å«ä¸‰å¤§ç±»å·¥å…·èŠ‚ç‚¹ï¼Œå¯æ»¡è¶³ä¸åŒä½¿ç”¨åœºæ™¯ã€‚

### 1. å¯è§†åŒ–é…æ–¹æŸ¥æ‰¾å™¨ (Visual Recipe Finder)

#### `Civitai Recipe Gallery` (Civitai é…æ–¹ç”»å»Š)

* **åŠŸèƒ½**:
  æµè§ˆæŒ‡å®šæœ¬åœ°æ¨¡å‹çš„çƒ­é—¨ä½œå“ç”»å»Šï¼Œæ”¯æŒä¸€é”®å¤ç°å®Œæ•´é…æ–¹ã€‚
* **æ–°å¢ç‰¹æ€§**:

  * ğŸš€ **ä¸€é”®åŠ è½½å·¥ä½œæµ**ï¼šæ™ºèƒ½å®‰å…¨åœ°åŠ è½½å›¾ç‰‡çš„åŸå§‹å·¥ä½œæµï¼ˆå…¼å®¹ ComfyUI-Managerï¼Œè‡ªåŠ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼‰ã€‚
  * ğŸ’¾ **ä¿å­˜æºæ–‡ä»¶**ï¼šä¸‹è½½åŒ…å«å®Œæ•´å…ƒæ•°æ®çš„åŸå§‹å›¾ç‰‡ï¼Œå­˜æ¡£åˆ° `output` æ–‡ä»¶å¤¹ã€‚

| è¾“å‡ºç«¯å£            | ç±»å‹              | è¯´æ˜                                          |
| --------------- | --------------- | ------------------------------------------- |
| `image`         | `IMAGE`         | é€‰ä¸­çš„ç¤ºä¾‹å›¾ç‰‡                                     |
| `info_md`       | `STRING`        | é…æ–¹å®Œæ•´ Markdown æŠ¥å‘Šï¼ˆæ¨èè¿æ¥åˆ° `MarkdownPresenter`ï¼‰ |
| `recipe_params` | `RECIPE_PARAMS` | æ ¸å¿ƒå‚æ•°ç®¡é“ï¼ˆéœ€é…åˆ `Get Parameters from Recipe` ä½¿ç”¨ï¼‰ |

> âš ï¸ **é¦–æ¬¡è¿è¡Œæç¤º**
>
> * åˆæ¬¡è¿è¡Œä¼šè®¡ç®—æ‰€æœ‰æœ¬åœ°æ¨¡å‹çš„ **hash**ï¼Œè€—æ—¶è¾ƒé•¿ã€‚
> * æ•°æ®ç¼“å­˜åœ¨ `Civitai_Recipe_Finder/data` ç›®å½•ï¼Œåç»­ä»…å¤„ç†æ–°å¢æ¨¡å‹ã€‚

![gallery example](./example_workflows/Recipe_Gallery.png)

#### `Get Parameters from Recipe` (ä»é…æ–¹è·å–å‚æ•°)

* **åŠŸèƒ½**: è§£åŒ… `recipe_params` ç®¡é“ï¼Œå°†å‚æ•°ç›´æ¥è¾“å‡ºï¼Œå¯ä¸ `KSampler` ç­‰ä¸‹æ¸¸èŠ‚ç‚¹å…¼å®¹ã€‚
* **è¾“å‡º**: `ckpt_name`, `positive_prompt`, `negative_prompt`, `seed`, `steps`, `cfg`, `sampler_name`, `scheduler`, `width`, `height`, `denoise`

---

### 2. æ¨¡å‹æ·±åº¦åˆ†æ (In-Depth Model Analysis)

æ ¸å¿ƒèŠ‚ç‚¹ï¼š**`Model Analyzer (Checkpoint / LoRA)`**

* **åŠŸèƒ½**:

  * ä¸€ç«™å¼å®Œæˆ **æ•°æ®æŠ“å– â†’ ç¤¾åŒºç»Ÿè®¡ â†’ å‚æ•°åˆ†æ â†’ æŠ¥å‘Šè¾“å‡º**
  * å–ä»£æ—§ç‰ˆ `Data Fetcher` + å¤šä¸ª Analyzer çš„ç¹çç»„åˆ
* **è¾“å…¥**: `model_name`, `image_limit`, `sort`, `nsfw_level`, `filter_type`, `summary_top_n`, `force_refresh`
* **è¾“å‡º**:

  * `full_report_md`: å®Œæ•´åˆ†ææŠ¥å‘Šï¼ˆMarkdownï¼‰
  * `fetch_summary`: æŠ“å–æ‘˜è¦ï¼ˆå¦‚â€œæˆåŠŸåˆ†æ 100 ä¸ªé¡¹ç›®â€ï¼‰
  * `params_pipe`: æœ€å¸¸ç”¨å‚æ•°ç®¡é“ï¼ˆé…åˆ `Get Parameters from Analysis` è§£åŒ…ï¼‰

![Model\_DeepResearch example](./example_workflows/Model_DeepResearch.png)

#### `Get Parameters from Analysis` (ä»åˆ†æè·å–å‚æ•°)

* **åŠŸèƒ½**: è§£åŒ… `params_pipe`ï¼Œæå–ç¤¾åŒºå¸¸ç”¨å‚æ•°ã€‚
* **è¾“å‡º**: ä¸ `Get Parameters from Recipe` ç›¸åŒã€‚

---

### 3. è½»é‡çº§å·¥å…· (Lightweight Tool)

#### `Lora Trigger Words` (LoRA è§¦å‘è¯)

* **åŠŸèƒ½**: å³æ—¶è·å–æŒ‡å®š LoRA çš„è§¦å‘è¯ã€‚
* **è¾“å‡º**:

  * `metadata_triggers`: æœ¬åœ°å…ƒæ•°æ®è§¦å‘è¯
  * `civitai_triggers`: å®˜æ–¹ API è§¦å‘è¯
  * `triggers_md`: ç²¾ç¾å¯¹ç…§è¡¨ï¼ˆMarkdownï¼‰

![lora\_trigger\_words example](./example_workflows/LoRA_Trigger_Words.png)

---

## å®‰è£…ä¸ä½¿ç”¨

1. å°†é¡¹ç›®æ–‡ä»¶å¤¹æ”¾å…¥ `ComfyUI/custom_nodes/`ï¼Œä¾‹å¦‚ï¼š

   ```bash
   ComfyUI/custom_nodes/CivitaiProject/
   ```
2. å®‰è£…ä¾èµ–ï¼š

   ```bash
   pip install -r requirements.txt
   ```
3. é‡å¯ ComfyUIï¼Œå³å¯åœ¨ `Civitai` èœå•ä¸­æ‰¾åˆ°èŠ‚ç‚¹ã€‚

> ğŸ’¡ **å°è´´å£«**:
> `Markdown Presenter` èŠ‚ç‚¹å¯åœ¨ `Display` èœå•æ‰¾åˆ°ï¼Œæˆ–åœ¨æœç´¢æ¡†ä¸­è¾“å…¥â€œMarkdown Presenterâ€ã€‚

---

## å·¥ä½œæµç¤ºä¾‹

* **ComfyUI å†…ç½®**: *Templates â†’ Custom Nodes â†’ ComfyUI-Civitai-Recipe*
* **ä»“åº“ç›®å½•**: [example\_workflows](./example_workflows)

---

## ç‰ˆæœ¬å…¼å®¹æ€§

* **3.1 åŠä¹‹å‰ç‰ˆæœ¬è¿ç§»**
  `Settings â†’ CivitaiUtils â†’ Migration`
  æ”¯æŒå°†æ—§ç‰ˆ JSON ç¼“å­˜ç›´æ¥è¿ç§»è‡³æ•°æ®åº“ã€‚

---

## å›½å†…ç½‘ç»œæ”¯æŒ

* åœ¨ `Settings â†’ CivitaiUtils â†’ Civitai Helper Network` ä¸­å¯é€‰æ‹©è®¿é—®ç¯å¢ƒï¼š

  * ğŸŒ **International** (é»˜è®¤) â€“ å›½é™…ç”¨æˆ·
  * ğŸ‡¨ğŸ‡³ **China Mirror** â€“ å›½å†…ç”¨æˆ·ï¼Œè®¿é—®æ›´å¿«æ›´ç¨³å®š

![Network\_setting](./image/Network_setting.png)

---

## æ›´æ–°æ—¥å¿—

### \[3.2.0] - 2025-09-23

#### æ–°å¢

* **æ•°æ®åº“ç®¡ç†é¢æ¿**ï¼šæ”¯æŒä¸€é”®æ¸…ç†ç¼“å­˜ï¼ˆåˆ†æå™¨ã€API å“åº”ã€è§¦å‘è¯ç­‰ï¼‰ã€‚
* **è§†é¢‘èµ„æºæ”¯æŒ**ï¼š`Recipe Gallery` ä¸ `Model Analyzer` ç°å·²æ”¯æŒè§†é¢‘é…æ–¹ã€‚

#### å˜æ›´

* **æ ¸å¿ƒæ¶æ„é‡æ„**ï¼šç¼“å­˜ç”±é›¶æ•£ JSON æ–‡ä»¶å‡çº§ä¸ºç»Ÿä¸€ `SQLite` æ•°æ®åº“ã€‚
* **èŠ‚ç‚¹ç®€åŒ–**ï¼šåˆå¹¶ä¸ºå•ä¸€ `Model Analyzer` èŠ‚ç‚¹ï¼Œæµç¨‹æ›´é«˜æ•ˆã€‚
* **å‘½åç»Ÿä¸€**ï¼š

  * `Recipe Params Parser` â†’ **`Get Parameters from Recipe`**
  * åˆ†æå‚æ•°è§£åŒ…èŠ‚ç‚¹ â†’ **`Get Parameters from Analysis`**
* **æ•°æ®åº“å·¥å…·**ï¼šæ–°å¢ **`ğŸ—ƒï¸ Database & Models`** é¢æ¿ï¼Œå¯æŸ¥çœ‹æ¨¡å‹ã€åˆ·æ–°æ•°æ®åº“ã€æ¸…é™¤ç¼“å­˜ï¼Œæ”¯æŒæ—§ç‰ˆæ•°æ®è¿ç§»ã€‚

---

## é¸£è°¢

* è§¦å‘è¯é€»è¾‘éƒ¨åˆ†å‚è€ƒè‡ªï¼š
  [Extraltodeus/LoadLoraWithTags](https://github.com/Extraltodeus/LoadLoraWithTags)
  [idrirap/ComfyUI-Lora-Auto-Trigger-Words](https://github.com/idrirap/ComfyUI-Lora-Auto-Trigger-Words)

* ç”»å»ŠèŠ‚ç‚¹è®¾è®¡æ€è·¯å‚è€ƒï¼š
  [Firetheft/ComfyUI\_Civitai\_Gallery](https://github.com/Firetheft/ComfyUI_Civitai_Gallery)

åœ¨æ­¤å‘ä»¥ä¸Šé¡¹ç›®åŠå…¶ä½œè€…ä»¬è‡´ä»¥è¯šæŒšçš„æ„Ÿè°¢ï¼

---